+function(c){var b=function(e,f){var m=this;this.options=f;this.$el=c(e);var u=this.$el,k,j,i,h,t=0,s=0,o=false,v,l;u.mousedown(function(w){if(u.data("component-attached")){return}d(w);return false});u.on("touchstart",function(x){if(u.data("component-attached")){return}var w=x.originalEvent;if(w.touches.length==1){d(w.touches[0]);x.stopPropagation()}});function r(w){h=c("#cms-master-tabs > div.tab-content > .tab-pane.active .control-componentlist");u.addClass(m.options.placeholderClass);k.show();j=c('#cms-master-tabs > div.tab-content > .tab-pane.active [data-control="codeeditor"]');if(!j.length){return}i=j.codeEditor("getEditorObject");i.focus();i.on("mousemove",function(x){l=x.getDocumentPosition();i.clearSelection();i.moveCursorToPosition(l)})}function d(y){v=u.offset();k=u.clone().appendTo(c(document.body));k.css({zIndex:"99999",position:"absolute",pointerEvents:"none"}).addClass("draggable-component-item").width(u.width()).height(u.height()).hide();var x=(y.pageX-v.left),w=(y.pageY-v.top);k.data("dragComponents",{x:x,y:w});if(Modernizr.touch){c(window).on("touchmove.oc.dragcomponents",function(A){var z=A.originalEvent;n(z.touches[0]);A.preventDefault()});c(window).on("touchend.oc.dragcomponents",function(z){q()})}else{c(window).on("mousemove.oc.dragcomponents",function(z){n(z);c(document.body).addClass(m.options.dragClass);return false});c(window).on("mouseup.oc.dragcomponents",function(z){var A=y.pageX==z.pageX&&y.pageY==z.pageY;q(A);return false})}}function n(w){if(!o){o=true;r(w)}s=c(window).scrollTop();t=c(window).scrollLeft();var x=k.data("dragComponents");k.css({left:(w.pageX-t-x.x),top:(w.pageY-s-x.y)});if(g(k,h)){h.addClass("droppable")}else{h.removeClass("droppable")}}function q(w){o=false;if(w){c(document.body).removeClass(m.options.dragClass)}u.removeClass(m.options.placeholderClass);c(window).off("mousemove.oc.dragcomponents mouseup.oc.dragcomponents").removeData("dragComponents");if(!w){p()}k.remove();window.setTimeout(function(){if(!w){c(document.body).removeClass(m.options.dragClass)}},100)}function p(){if(g(k,j)){u.click();if(h.length&&i){var w=c('input[name="component_aliases[]"]',u).val();i.insert("{% component '"+w+"' %}")}}else{if(g(k,h)){u.click()}}if(i){i.removeAllListeners("mousemove");i.blur()}if(h.length){h.removeClass("droppable")}}function g(C,A){if(!C||!A||!C.length||!A.length){return false}var x=C.offset().left,I=C.offset().top,F=C.outerHeight(true),D=C.outerWidth(true),J=I+F,z=x+D,w=A.offset().left,H=A.offset().top,E=A.outerHeight(true),B=A.outerWidth(true),G=H+E,y=w+B;return !(J<H||I>G||z<w||x>y)}};b.DEFAULTS={dragClass:"drag",placeholderClass:"placeholder"};var a=c.fn.dragComponents;c.fn.dragComponents=function(e){var d=Array.prototype.slice.call(arguments,1);return this.each(function(){var h=c(this);var g=h.data("oc.dragcomponents");var f=c.extend({},b.DEFAULTS,h.data(),typeof e=="object"&&e);if(!g){h.data("oc.dragcomponents",(g=new b(this,f)))}else{if(typeof e=="string"){g[e].apply(g,d)}}})};c.fn.dragComponents.Constructor=b;c.fn.dragComponents.noConflict=function(){c.fn.dragComponents=a;return this};c(document).on("mouseenter.oc.dragcomponents",'[data-control="dragcomponent"]',function(){c(this).dragComponents()})}(window.jQuery);