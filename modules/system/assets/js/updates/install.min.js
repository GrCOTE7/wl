+function(a){var b=function(){this.init()};b.prototype.init=function(){var c=this;this.dataSet={};a(document).ready(function(){c.bindSearch("#pluginSearchInput");c.bindSearch("#themeSearchInput");c.bindSuggested("#suggestedPlugins");c.bindSuggested("#suggestedThemes")})};b.prototype.bindSearch=function(h){var e=a(h),c=e.closest("form"),d=e.data("searchType");if(e.length==0){return}var g=['<div class="product-details">','<div class="product-image"><img src="{{image}}" alt=""></div>','<div class="product-name ">{{name}}</div>','<div class="product-description text-overflow">{{description}}</div>',"</div>"].join("");Mustache.parse(g);var i=function(j,k){return Mustache.render(g,j,k)};var f=new Bloodhound({name:"products",method:"POST",remote:{url:window.location.pathname+"?search="+d+"&query=%QUERY",ajax:{beforeSend:function(){a(".icon",c).hide();a(".icon.loading",c).show();e.data("searchReady",false)},complete:function(){a(".icon",c).show();a(".icon.loading",c).hide();e.data("searchReady",true)}}},datumTokenizer:function(j){return Bloodhound.tokenizers.whitespace(j.val)},queryTokenizer:Bloodhound.tokenizers.whitespace,limit:5});f.initialize();a(h).typeahead(null,{displayKey:"code",source:f.ttAdapter(),minLength:3,templates:{suggestion:i}}).on("typeahead:opened",function(){a(h+" .tt-dropdown-menu").css("width",a(h).width()+"px")}).on("typeahead:selected",function(k,j){c.submit()}).on("keypress",function(j){if(j.keyCode==13){c.submit()}})};b.prototype.searchSubmit=function(d){var c=a(d),e=c.find(".product-search-input.tt-input:first");if(!e.data("searchReady")){return}c.popup();e.typeahead("val","")};b.prototype.bindSuggested=function(e){var c=this,d=a(e).data("handler");a.request(d).done(function(g){var f=g.result;if(!a.isArray(f)){return}c.renderSuggested(e,f)})};b.prototype.renderSuggested=function(g,c){var e=this,f=a(g),h=f.closest(".suggested-products-container"),d=a(g).data("view");if(c.length==0){h.hide()}else{h.show();a.each(c,function(i,j){e.renderPartial(f,d,j,{append:true})})}};b.prototype.renderPartial=function(f,e,i,d){var c=f,g=a('[data-partial="'+e+'"]'),h=Mustache.to_html(g.html(),i);d=a.extend(true,{append:false},d);if(d.append){c.append(h)}else{c.html(h)}};if(a.oc===undefined){a.oc={}}a.oc.installProcess=new b}(window.jQuery);
/*!
 * typeahead.js 0.10.1
 * https://github.com/twitter/typeahead.js
 * Copyright 2013 Twitter, Inc. and other contributors; Licensed MIT
 */
!function(H){var G={isMsie:function(){return/(msie|trident)/i.test(navigator.userAgent)?navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]:!1},isBlankString:function(b){return !b||/^\s*$/.test(b)},escapeRegExChars:function(b){return b.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(b){return"string"==typeof b},isNumber:function(b){return"number"==typeof b},isArray:H.isArray,isFunction:H.isFunction,isObject:H.isPlainObject,isUndefined:function(b){return"undefined"==typeof b},bind:H.proxy,each:function(a,f){function e(d,c){return f(c,d)}H.each(a,e)},map:H.map,filter:H.grep,every:function(a,f){var e=!0;return a?(H.each(a,function(b,c){return(e=f.call(null,c,b,a))?void 0:!1}),!!e):e},some:function(a,f){var e=!1;return a?(H.each(a,function(b,c){return(e=f.call(null,c,b,a))?!1:void 0}),!!e):e},mixin:H.extend,getUniqueId:function(){var b=0;return function(){return b++}}(),templatify:function(a){function d(){return String(a)}return H.isFunction(a)?a:d},defer:function(b){setTimeout(b,0)},debounce:function(g,f,j){var i,h;return function(){var d,c,b=this,a=arguments;return d=function(){i=null,j||(h=g.apply(b,a))},c=j&&!i,clearTimeout(i),i=setTimeout(d,f),c&&(h=g.apply(b,a)),h}},throttle:function(j,i){var p,o,n,m,l,k;return l=0,k=function(){l=new Date,n=null,m=j.apply(p,o)},function(){var b=new Date,a=i-(b-l);return p=this,o=arguments,0>=a?(clearTimeout(n),n=null,l=b,m=j.apply(p,o)):n||(n=setTimeout(k,a)),m}},noop:function(){}},F="0.10.1",E=function(){function b(c){this.maxSize=c||100,this.size=0,this.hash={},this.list=new f}function f(){this.head=this.tail=null}function e(d,c){this.key=d,this.val=c,this.prev=this.next=null}return G.mixin(b.prototype,{set:function(g,d){var i,h=this.list.tail;this.size>=this.maxSize&&(this.list.remove(h),delete this.hash[h.key]),(i=this.hash[g])?(i.val=d,this.list.moveToFront(i)):(i=new e(g,d),this.list.add(i),this.hash[g]=i,this.size++)},get:function(d){var c=this.hash[d];return c?(this.list.moveToFront(c),c.val):void 0}}),G.mixin(f.prototype,{add:function(c){this.head&&(c.next=this.head,this.head.prev=c),this.head=c,this.tail=this.tail||c},remove:function(c){c.prev?c.prev.next=c.next:this.head=c.next,c.next?c.next.prev=c.prev:this.tail=c.prev},moveToFront:function(c){this.remove(c),this.add(c)}}),b}(this),D=function(){function b(c){this.prefix=["__",c,"__"].join(""),this.ttlKey="__ttl__",this.keyMatcher=new RegExp("^"+this.prefix)}function n(){return(new Date).getTime()}function m(c){return JSON.stringify(G.isUndefined(c)?null:c)}function l(c){return JSON.parse(c)}var k,j;try{k=window.localStorage,k.setItem("~~~","!"),k.removeItem("~~~")}catch(i){k=null}return j=k&&window.JSON?{_prefix:function(c){return this.prefix+c},_ttlKey:function(c){return this._prefix(c)+this.ttlKey},get:function(c){return this.isExpired(c)&&this.remove(c),l(k.getItem(this._prefix(c)))},set:function(c,f,d){return G.isNumber(d)?k.setItem(this._ttlKey(c),m(n()+d)):k.removeItem(this._ttlKey(c)),k.setItem(this._prefix(c),m(f))},remove:function(c){return k.removeItem(this._ttlKey(c)),k.removeItem(this._prefix(c)),this},clear:function(){var f,e,h=[],g=k.length;for(f=0;g>f;f++){(e=k.key(f)).match(this.keyMatcher)&&h.push(e.replace(this.keyMatcher,""))}for(f=h.length;f--;){this.remove(h[f])}return this},isExpired:function(c){var e=l(k.getItem(this._ttlKey(c)));return G.isNumber(e)&&n()>e?!0:!1}}:{get:G.noop,set:G.noop,remove:G.noop,clear:G.noop,isExpired:G.noop},G.mixin(b.prototype,j),b}(),C=function(){function l(c){c=c||{},this._send=c.transport?k(c.transport):H.ajax,this._get=c.rateLimiter?c.rateLimiter(this._get):this._get}function k(e){return function(o,n){function m(f){G.defer(function(){c.resolve(f)})}function i(f){G.defer(function(){c.reject(f)})}var c=H.Deferred();return e(o,n,m,i),c}}var j=0,d={},b=6,a=new E(10);return l.setMaxPendingRequests=function(c){b=c},l.resetCache=function(){a=new E(10)},G.mixin(l.prototype,{_get:function(g,f,o){function n(c){o&&o(c),a.set(g,c)}function m(){j--,delete d[g],h.onDeckRequestArgs&&(h._get.apply(h,h.onDeckRequestArgs),h.onDeckRequestArgs=null)}var i,h=this;(i=d[g])?i.done(n):b>j?(j++,d[g]=this._send(g,f).done(n).always(m)):this.onDeckRequestArgs=[].slice.call(arguments,0)},get:function(f,i,h){var g;return G.isFunction(i)&&(h=i,i={}),(g=a.get(f))?G.defer(function(){h&&h(g)}):this._get(f,i,h),!!g}}),l}(),B=function(){function j(c){c=c||{},c.datumTokenizer&&c.queryTokenizer||H.error("datumTokenizer and queryTokenizer are both required"),this.datumTokenizer=c.datumTokenizer,this.queryTokenizer=c.queryTokenizer,this.datums=[],this.trie=h()}function i(c){return c=G.filter(c,function(d){return !!d}),c=G.map(c,function(d){return d.toLowerCase()})}function h(){return{ids:[],children:{}}}function b(f){for(var e={},k=[],g=0;g<f.length;g++){e[f[g]]||(e[f[g]]=!0,k.push(f[g]))}return k}function a(k,g){function o(d,c){return d-c}var n=0,m=0,l=[];for(k=k.sort(o),g=g.sort(o);n<k.length&&m<g.length;){k[n]<g[m]?n++:k[n]>g[m]?m++:(l.push(k[n]),n++,m++)}return l}return G.mixin(j.prototype,{bootstrap:function(c){this.datums=c.datums,this.trie=c.trie},add:function(d){var e=this;d=G.isArray(d)?d:[d],G.each(d,function(c){var l,k;l=e.datums.push(c)-1,k=i(e.datumTokenizer(c)),G.each(k,function(m){var f,o,n;for(f=e.trie,o=m.split("");n=o.shift();){f=f.children[n]||(f.children[n]=h()),f.ids.push(l)}})})},get:function(d){var k,g,f=this;return k=i(this.queryTokenizer(d)),G.each(k,function(l){var e,o,n,m;if(g&&0===g.length){return !1}for(e=f.trie,o=l.split("");e&&(n=o.shift());){e=e.children[n]}return e&&0===o.length?(m=e.ids.slice(0),void (g=g?a(g,m):m)):(g=[],!1)}),g?G.map(b(g),function(c){return f.datums[c]}):[]},serialize:function(){return{datums:this.datums,trie:this.trie}}}),j}(),A=function(){function c(d){var e=d.local||null;return G.isFunction(e)&&(e=e.call(null)),e}function b(i){var h,g;return g={url:null,thumbprint:"",ttl:86400000,filter:null,ajax:{}},(h=i.prefetch||null)&&(h=G.isString(h)?{url:h}:h,h=G.mixin(g,h),h.thumbprint=F+h.thumbprint,h.ajax.type=h.ajax.type||"GET",h.ajax.dataType=h.ajax.dataType||"json",!h.url&&H.error("prefetch requires url to be set")),h}function a(l){function k(d){return function(e){return G.debounce(e,d)}}function j(d){return function(e){return G.throttle(e,d)}}var i,h;return h={url:null,wildcard:"%QUERY",replace:null,rateLimitBy:"debounce",rateLimitWait:300,send:null,filter:null,ajax:{}},(i=l.remote||null)&&(i=G.isString(i)?{url:i}:i,i=G.mixin(h,i),i.rateLimiter=/^throttle$/i.test(i.rateLimitBy)?j(i.rateLimitWait):k(i.rateLimitWait),i.ajax.type=i.ajax.type||"GET",i.ajax.dataType=i.ajax.dataType||"json",delete i.rateLimitBy,delete i.rateLimitWait,!i.url&&H.error("remote requires url to be set")),i}return{local:c,prefetch:b,remote:a}}(),z=(window.Bloodhound=function(){function f(c){c&&(c.local||c.prefetch||c.remote)||H.error("one of local, prefetch, or remote is required"),this.limit=c.limit||5,this.sorter=e(c.sorter),this.dupDetector=c.dupDetector||b,this.local=A.local(c),this.prefetch=A.prefetch(c),this.remote=A.remote(c),this.cacheKey=this.prefetch?this.prefetch.cacheKey||this.prefetch.url:null,this.index=new B({datumTokenizer:c.datumTokenizer,queryTokenizer:c.queryTokenizer}),this.storage=this.cacheKey?new D(this.cacheKey):null}function e(g){function i(c){return c.sort(g)}function h(c){return c}return G.isFunction(g)?i:h}function b(){return !1}var a;return a={data:"data",protocol:"protocol",thumbprint:"thumbprint"},f.tokenizers={whitespace:function(c){return c.split(/\s+/)},nonword:function(c){return c.split(/\W+/)}},G.mixin(f.prototype,{_loadPrefetch:function(g){function k(d){var l;l=g.filter?g.filter(d):d,h.add(l),h._saveToStorage(h.index.serialize(),g.thumbprint,g.ttl)}var j,i,h=this;return(j=this._readFromStorage(g.thumbprint))?(this.index.bootstrap(j),i=H.Deferred().resolve()):i=H.ajax(g.url,g.ajax).done(k),i},_getFromRemote:function(h,g){function l(d){var m=i.remote.filter?i.remote.filter(d):d;g(m)}var k,j,i=this;return h=h||"",j=encodeURIComponent(h),k=this.remote.replace?this.remote.replace(this.remote.url,h):this.remote.url.replace(this.remote.wildcard,j),this.transport.get(k,this.remote.ajax,l)},_saveToStorage:function(g,d,h){this.storage&&(this.storage.set(a.data,g,h),this.storage.set(a.protocol,location.protocol,h),this.storage.set(a.thumbprint,d,h))},_readFromStorage:function(g){var d,h={};return this.storage&&(h.data=this.storage.get(a.data),h.protocol=this.storage.get(a.protocol),h.thumbprint=this.storage.get(a.thumbprint)),d=h.thumbprint!==g||h.protocol!==location.protocol,h.data&&!d?h.data:null},initialize:function(){function g(){h.add(h.local)}var i,h=this;return i=this.prefetch?this._loadPrefetch(this.prefetch):H.Deferred().resolve(),this.local&&i.done(g),this.transport=this.remote?new C(this.remote):null,this.initialize=function(){return i.promise()},i.promise()},add:function(c){this.index.add(c)},get:function(h,m){function l(c){var g=k.slice(0);G.each(c,function(d){var n;return n=G.some(g,function(o){return j.dupDetector(d,o)}),!n&&g.push(d),g.length<j.limit}),m&&m(j.sorter(g))}var k,j=this,i=!1;k=this.index.get(h),k=this.sorter(k).slice(0,this.limit),k.length<this.limit&&this.transport&&(i=this._getFromRemote(h,l)),!i&&m&&m(k)},ttAdapter:function(){return G.bind(this.get,this)}}),f}(),{wrapper:'<span class="twitter-typeahead"></span>',dropdown:'<span class="tt-dropdown-menu"></span>',dataset:'<div class="tt-dataset-%CLASS%"></div>',suggestions:'<span class="tt-suggestions"></span>',suggestion:'<div class="tt-suggestion">%BODY%</div>'}),y={wrapper:{position:"relative",display:"inline-block"},hint:{position:"absolute",top:"0",left:"0",borderColor:"transparent",boxShadow:"none"},input:{position:"relative",verticalAlign:"top",backgroundColor:"transparent"},inputWithNoHint:{position:"relative",verticalAlign:"top"},dropdown:{position:"absolute",top:"100%",left:"0",zIndex:"100",display:"none"},suggestions:{display:"block"},suggestion:{whiteSpace:"nowrap",cursor:"pointer"},suggestionChild:{whiteSpace:"normal"},ltr:{left:"0",right:"auto"},rtl:{left:"auto",right:" 0"}};G.isMsie()&&G.mixin(y.input,{backgroundImage:"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)"}),G.isMsie()&&G.isMsie()<=7&&G.mixin(y.input,{marginTop:"-1px"});var x=function(){function b(c){c&&c.el||H.error("EventBus initialized without el"),this.$el=H(c.el)}var a="typeahead:";return G.mixin(b.prototype,{trigger:function(d){var c=[].slice.call(arguments,1);this.$el.trigger(a+d,c)}}),b}(),w=function(){function K(g,f,j,i){var h;if(!j){return this}for(f=f.split(l),j=i?m(j,i):j,this._callbacks=this._callbacks||{};h=f.shift();){this._callbacks[h]=this._callbacks[h]||{sync:[],async:[]},this._callbacks[h][g].push(j)}return this}function J(a,f,e){return K.call(this,"async",a,f,e)}function I(a,f,e){return K.call(this,"sync",a,f,e)}function q(d){var c;if(!this._callbacks){return this}for(d=d.split(l);c=d.shift();){delete this._callbacks[c]}return this}function p(h){var f,M,L,j,i;if(!this._callbacks){return this}for(h=h.split(l),L=[].slice.call(arguments,1);(f=h.shift())&&(M=this._callbacks[f]);){j=o(M.sync,this,[f].concat(L)),i=o(M.async,this,[f].concat(L)),j()&&k(i)}return this}function o(f,e,h){function g(){for(var b,a=0;!b&&a<f.length;a+=1){b=f[a].apply(e,h)===!1}return !b}return g}function n(){var b;return b=window.setImmediate?function(c){setImmediate(function(){c()})}:function(c){setTimeout(function(){c()},0)}}function m(d,c){return d.bind?d.bind(c):function(){d.apply(c,[].slice.call(arguments,0))}}var l=/\s+/,k=n();return{onSync:I,onAsync:J,off:q,trigger:p}}(),v=function(b){function f(h,m,l){for(var k,j=[],i=0;i<h.length;i++){j.push(G.escapeRegExChars(h[i]))}return k=l?"\\b("+j.join("|")+")\\b":"("+j.join("|")+")",m?new RegExp(k):new RegExp(k,"i")}var e={node:null,pattern:null,tagName:"strong",className:null,wordsOnly:!1,caseSensitive:!1};return function(i){function d(g){var j,h;return(j=a.exec(g.data))&&(wrapperNode=b.createElement(i.tagName),i.className&&(wrapperNode.className=i.className),h=g.splitText(j.index),h.splitText(j[0].length),wrapperNode.appendChild(h.cloneNode(!0)),g.parentNode.replaceChild(wrapperNode,h)),!!j}function c(h,g){for(var l,k=3,j=0;j<h.childNodes.length;j++){l=h.childNodes[j],l.nodeType===k?j+=g(l)?1:0:c(l,g)}}var a;i=G.mixin({},e,i),i.node&&i.pattern&&(i.pattern=G.isArray(i.pattern)?i.pattern:[i.pattern],a=f(i.pattern,i.caseSensitive,i.wordsOnly),c(i.node,d))}}(window.document),u=function(){function j(n){var m,l,k,g,d=this;n=n||{},n.input||H.error("input is missing"),m=G.bind(this._onBlur,this),l=G.bind(this._onFocus,this),k=G.bind(this._onKeydown,this),g=G.bind(this._onInput,this),this.$hint=H(n.hint),this.$input=H(n.input).on("blur.tt",m).on("focus.tt",l).on("keydown.tt",k),0===this.$hint.length&&(this.setHintValue=this.getHintValue=this.clearHint=G.noop),G.isMsie()?this.$input.on("keydown.tt keypress.tt cut.tt paste.tt",function(c){a[c.which||c.keyCode]||G.defer(G.bind(d._onInput,d,c))}):this.$input.on("input.tt",g),this.query=this.$input.val(),this.$overflowHelper=i(this.$input)}function i(c){return H('<pre aria-hidden="true"></pre>').css({position:"absolute",visibility:"hidden",whiteSpace:"nowrap",fontFamily:c.css("font-family"),fontSize:c.css("font-size"),fontStyle:c.css("font-style"),fontVariant:c.css("font-variant"),fontWeight:c.css("font-weight"),wordSpacing:c.css("word-spacing"),letterSpacing:c.css("letter-spacing"),textIndent:c.css("text-indent"),textRendering:c.css("text-rendering"),textTransform:c.css("text-transform")}).insertAfter(c)}function h(d,c){return j.normalizeQuery(d)===j.normalizeQuery(c)}function b(c){return c.altKey||c.ctrlKey||c.metaKey||c.shiftKey}var a;return a={9:"tab",27:"esc",37:"left",39:"right",13:"enter",38:"up",40:"down"},j.normalizeQuery=function(c){return(c||"").replace(/^\s*/g,"").replace(/\s{2,}/g," ")},G.mixin(j.prototype,w,{_onBlur:function(){this.resetInputValue(),this.trigger("blurred")},_onFocus:function(){this.trigger("focused")},_onKeydown:function(d){var c=a[d.which||d.keyCode];this._managePreventDefault(c,d),c&&this._shouldTrigger(c,d)&&this.trigger(c+"Keyed",d)},_onInput:function(){this._checkInputValue()},_managePreventDefault:function(g,f){var m,l,k;switch(g){case"tab":l=this.getHintValue(),k=this.getInputValue(),m=l&&l!==k&&!b(f);break;case"up":case"down":m=!b(f);break;default:m=!1}m&&f.preventDefault()},_shouldTrigger:function(e,d){var f;switch(e){case"tab":f=!b(d);break;default:f=!0}return f},_checkInputValue:function(){var e,d,f;e=this.getInputValue(),d=h(e,this.query),f=d?this.query.length!==e.length:!1,d?f&&this.trigger("whitespaceChanged",this.query):this.trigger("queryChanged",this.query=e)},focus:function(){this.$input.focus()},blur:function(){this.$input.blur()},getQuery:function(){return this.query},setQuery:function(c){this.query=c},getInputValue:function(){return this.$input.val()},setInputValue:function(d,c){this.$input.val(d),!c&&this._checkInputValue()},getHintValue:function(){return this.$hint.val()},setHintValue:function(c){this.$hint.val(c)},resetInputValue:function(){this.$input.val(this.query)},clearHint:function(){this.$hint.val("")},getLanguageDirection:function(){return(this.$input.css("direction")||"ltr").toLowerCase()},hasOverflow:function(){var c=this.$input.width()-2;return this.$overflowHelper.text(this.getInputValue()),this.$overflowHelper.width()>=c},isCursorAtEnd:function(){var e,g,f;return e=this.$input.val().length,g=this.$input[0].selectionStart,G.isNumber(g)?g===e:document.selection?(f=document.selection.createRange(),f.moveStart("character",-e),e===f.text.length):!0},destroy:function(){this.$hint.off(".tt"),this.$input.off(".tt"),this.$hint=this.$input=this.$overflowHelper=null}}),j}(),t=function(){function n(d){d=d||{},d.templates=d.templates||{},d.source||H.error("missing source"),d.name&&!j(d.name)&&H.error("invalid dataset name: "+d.name),this.query=null,this.highlight=!!d.highlight,this.name=d.name||G.getUniqueId(),this.source=d.source,this.displayFn=m(d.display||d.displayKey),this.templates=l(d.templates,this.displayFn),this.$el=H(z.dataset.replace("%CLASS%",this.name))}function m(d){function e(c){return c[d]}return d=d||"value",G.isFunction(d)?d:e}function l(e,g){function f(c){return"<p>"+g(c)+"</p>"}return{empty:e.empty&&G.templatify(e.empty),header:e.header&&G.templatify(e.header),footer:e.footer&&G.templatify(e.footer),suggestion:e.suggestion||f}}function j(c){return/^[_a-zA-Z0-9-]+$/.test(c)}var i="ttDataset",b="ttValue",a="ttDatum";return n.extractDatasetName=function(c){return H(c).data(i)},n.extractValue=function(c){return H(c).data(b)},n.extractDatum=function(c){return H(c).data(a)},G.mixin(n.prototype,w,{_render:function(L,J){function q(){return k.templates.empty({query:L,isEmpty:!0})}function h(){function o(f){var N,M,p;return M=k.templates.suggestion(f),p=z.suggestion.replace("%BODY%",M),N=H(p).data(i,k.name).data(b,k.displayFn(f)).data(a,f),N.children().each(function(){H(this).css(y.suggestionChild)}),N}var d,c;return d=H(z.suggestions).css(y.suggestions),c=G.map(J,o),d.append.apply(d,c),k.highlight&&v({node:d[0],pattern:L}),d}function g(){return k.templates.header({query:L,isEmpty:!I})}function K(){return k.templates.footer({query:L,isEmpty:!I})}if(this.$el){var I,k=this;this.$el.empty(),I=J&&J.length,!I&&this.templates.empty?this.$el.html(q()).prepend(k.templates.header?g():null).append(k.templates.footer?K():null):I&&this.$el.html(h()).prepend(k.templates.header?g():null).append(k.templates.footer?K():null),this.trigger("rendered")}},getRoot:function(){return this.$el},update:function(e){function d(c){e===f.query&&f._render(e,c)}var f=this;this.query=e,this.source(e,d)},clear:function(){this._render(this.query||"")},isEmpty:function(){return this.$el.is(":empty")},destroy:function(){this.$el=null}}),n}(),s=function(){function b(l){var k,j,i,d=this;l=l||{},l.menu||H.error("menu is required"),this.isOpen=!1,this.isEmpty=!0,this.datasets=G.map(l.datasets,a),k=G.bind(this._onSuggestionClick,this),j=G.bind(this._onSuggestionMouseEnter,this),i=G.bind(this._onSuggestionMouseLeave,this),this.$menu=H(l.menu).on("click.tt",".tt-suggestion",k).on("mouseenter.tt",".tt-suggestion",j).on("mouseleave.tt",".tt-suggestion",i),G.each(this.datasets,function(c){d.$menu.append(c.getRoot()),c.onSync("rendered",d._onRendered,d)})}function a(c){return new t(c)}return G.mixin(b.prototype,w,{_onSuggestionClick:function(c){this.trigger("suggestionClicked",H(c.currentTarget))},_onSuggestionMouseEnter:function(c){this._removeCursor(),this._setCursor(H(c.currentTarget),!0)},_onSuggestionMouseLeave:function(){this._removeCursor()},_onRendered:function(){function c(d){return d.isEmpty()}this.isEmpty=G.every(this.datasets,c),this.isEmpty?this._hide():this.isOpen&&this._show(),this.trigger("datasetRendered")},_hide:function(){this.$menu.hide()},_show:function(){this.$menu.css("display","block")},_getSuggestions:function(){return this.$menu.find(".tt-suggestion")},_getCursor:function(){return this.$menu.find(".tt-cursor").first()},_setCursor:function(d,c){d.first().addClass("tt-cursor"),!c&&this.trigger("cursorMoved")},_removeCursor:function(){this._getCursor().removeClass("tt-cursor")},_moveCursor:function(g){var f,j,i,h;if(this.isOpen){if(j=this._getCursor(),f=this._getSuggestions(),this._removeCursor(),i=f.index(j)+g,i=(i+1)%(f.length+1)-1,-1===i){return void this.trigger("cursorRemoved")}-1>i&&(i=f.length-1),this._setCursor(h=f.eq(i)),this._ensureVisible(h)}},_ensureVisible:function(g){var f,j,i,h;f=g.position().top,j=f+g.outerHeight(!0),i=this.$menu.scrollTop(),h=this.$menu.height()+parseInt(this.$menu.css("paddingTop"),10)+parseInt(this.$menu.css("paddingBottom"),10),0>f?this.$menu.scrollTop(i+f):j>h&&this.$menu.scrollTop(i+(j-h))},close:function(){this.isOpen&&(this.isOpen=!1,this._removeCursor(),this._hide(),this.trigger("closed"))},open:function(){this.isOpen||(this.isOpen=!0,!this.isEmpty&&this._show(),this.trigger("opened"))},setLanguageDirection:function(c){this.$menu.css("ltr"===c?y.ltr:y.rtl)},moveCursorUp:function(){this._moveCursor(-1)},moveCursorDown:function(){this._moveCursor(1)},getDatumForSuggestion:function(d){var c=null;return d.length&&(c={raw:t.extractDatum(d),value:t.extractValue(d),datasetName:t.extractDatasetName(d)}),c},getDatumForCursor:function(){return this.getDatumForSuggestion(this._getCursor().first())},getDatumForTopSuggestion:function(){return this.getDatumForSuggestion(this._getSuggestions().first())},update:function(d){function e(c){c.update(d)}G.each(this.datasets,e)},empty:function(){function c(d){d.clear()}G.each(this.datasets,c),this.isEmpty=!0},isVisible:function(){return this.isOpen&&!this.isEmpty},destroy:function(){function c(d){d.destroy()}this.$menu.off(".tt"),this.$menu=null,G.each(this.datasets,c)}}),b}(),r=function(){function j(m){var l,k,d;m=m||{},m.input||H.error("missing input"),this.autoselect=!!m.autoselect,this.minLength=G.isNumber(m.minLength)?m.minLength:1,this.$node=i(m.input,m.withHint),l=this.$node.find(".tt-dropdown-menu"),k=this.$node.find(".tt-input"),d=this.$node.find(".tt-hint"),this.eventBus=m.eventBus||new x({el:k}),this.dropdown=new s({menu:l,datasets:m.datasets}).onSync("suggestionClicked",this._onSuggestionClicked,this).onSync("cursorMoved",this._onCursorMoved,this).onSync("cursorRemoved",this._onCursorRemoved,this).onSync("opened",this._onOpened,this).onSync("closed",this._onClosed,this).onAsync("datasetRendered",this._onDatasetRendered,this),this.input=new u({input:k,hint:d}).onSync("focused",this._onFocused,this).onSync("blurred",this._onBlurred,this).onSync("enterKeyed",this._onEnterKeyed,this).onSync("tabKeyed",this._onTabKeyed,this).onSync("escKeyed",this._onEscKeyed,this).onSync("upKeyed",this._onUpKeyed,this).onSync("downKeyed",this._onDownKeyed,this).onSync("leftKeyed",this._onLeftKeyed,this).onSync("rightKeyed",this._onRightKeyed,this).onSync("queryChanged",this._onQueryChanged,this).onSync("whitespaceChanged",this._onWhitespaceChanged,this),l.on("mousedown.tt",function(c){G.isMsie()&&G.isMsie()<9&&(k[0].onbeforedeactivate=function(){window.event.returnValue=!1,k[0].onbeforedeactivate=null}),c.preventDefault()})}function i(e,q){var p,o,n,m;p=H(e),o=H(z.wrapper).css(y.wrapper),n=H(z.dropdown).css(y.dropdown),m=p.clone().css(y.hint).css(h(p)),m.val("").removeData().addClass("tt-hint").removeAttr("id name placeholder").prop("disabled",!0).attr({autocomplete:"off",spellcheck:"false"}),p.data(a,{dir:p.attr("dir"),autocomplete:p.attr("autocomplete"),spellcheck:p.attr("spellcheck"),style:p.attr("style")}),p.addClass("tt-input").attr({autocomplete:"off",spellcheck:!1}).css(q?y.input:y.inputWithNoHint);try{!p.attr("dir")&&p.attr("dir","auto")}catch(g){}return p.wrap(o).parent().prepend(q?m:null).append(n)}function h(c){return{backgroundAttachment:c.css("background-attachment"),backgroundClip:c.css("background-clip"),backgroundColor:c.css("background-color"),backgroundImage:c.css("background-image"),backgroundOrigin:c.css("background-origin"),backgroundPosition:c.css("background-position"),backgroundRepeat:c.css("background-repeat"),backgroundSize:c.css("background-size")}}function b(d){var e=d.find(".tt-input");G.each(e.data(a),function(c,f){G.isUndefined(c)?e.removeAttr(f):e.attr(f,c)}),e.detach().removeData(a).removeClass("tt-input").insertAfter(d),d.remove()}var a="ttAttrs";return G.mixin(j.prototype,{_onSuggestionClicked:function(e,d){var f;(f=this.dropdown.getDatumForSuggestion(d))&&this._select(f)},_onCursorMoved:function(){var c=this.dropdown.getDatumForCursor();this.input.clearHint(),this.input.setInputValue(c.value,!0),this.eventBus.trigger("cursorchanged",c.raw,c.datasetName)},_onCursorRemoved:function(){this.input.resetInputValue(),this._updateHint()},_onDatasetRendered:function(){this._updateHint()},_onOpened:function(){this._updateHint(),this.eventBus.trigger("opened")},_onClosed:function(){this.input.clearHint(),this.eventBus.trigger("closed")},_onFocused:function(){this.dropdown.empty(),this.dropdown.open()},_onBlurred:function(){this.dropdown.close()},_onEnterKeyed:function(f,e){var k,g;k=this.dropdown.getDatumForCursor(),g=this.dropdown.getDatumForTopSuggestion(),k?(this._select(k),e.preventDefault()):this.autoselect&&g&&(this._select(g),e.preventDefault())},_onTabKeyed:function(e,d){var f;(f=this.dropdown.getDatumForCursor())?(this._select(f),d.preventDefault()):this._autocomplete()},_onEscKeyed:function(){this.dropdown.close(),this.input.resetInputValue()},_onUpKeyed:function(){var c=this.input.getQuery();!this.dropdown.isOpen&&c.length>=this.minLength&&this.dropdown.update(c),this.dropdown.open(),this.dropdown.moveCursorUp()},_onDownKeyed:function(){var c=this.input.getQuery();!this.dropdown.isOpen&&c.length>=this.minLength&&this.dropdown.update(c),this.dropdown.open(),this.dropdown.moveCursorDown()},_onLeftKeyed:function(){"rtl"===this.dir&&this._autocomplete()},_onRightKeyed:function(){"ltr"===this.dir&&this._autocomplete()},_onQueryChanged:function(d,c){this.input.clearHint(),this.dropdown.empty(),c.length>=this.minLength&&this.dropdown.update(c),this.dropdown.open(),this._setLanguageDirection()},_onWhitespaceChanged:function(){this._updateHint(),this.dropdown.open()},_setLanguageDirection:function(){var c;this.dir!==(c=this.input.getLanguageDirection())&&(this.dir=c,this.$node.css("direction",c),this.dropdown.setLanguageDirection(c))},_updateHint:function(){var k,p,o,n,m,l;k=this.dropdown.getDatumForTopSuggestion(),k&&this.dropdown.isVisible()&&!this.input.hasOverflow()&&(p=this.input.getInputValue(),o=u.normalizeQuery(p),n=G.escapeRegExChars(o),m=new RegExp("^(?:"+n+")(.*$)","i"),l=m.exec(k.value),this.input.setHintValue(p+(l?l[1]:"")))},_autocomplete:function(){var e,d,f;e=this.input.getHintValue(),d=this.input.getQuery(),e&&d!==e&&this.input.isCursorAtEnd()&&(f=this.dropdown.getDatumForTopSuggestion(),f&&this.input.setInputValue(f.value),this.eventBus.trigger("autocompleted",f.raw,f.datasetName))},_select:function(c){this.input.clearHint(),this.input.setQuery(c.value),this.input.setInputValue(c.value,!0),this._setLanguageDirection(),this.eventBus.trigger("selected",c.raw,c.datasetName),this.dropdown.close(),G.defer(G.bind(this.dropdown.empty,this.dropdown))},open:function(){this.dropdown.open()},close:function(){this.dropdown.close()},getQuery:function(){return this.input.getQuery()},setQuery:function(c){this.input.setInputValue(c)},destroy:function(){this.input.destroy(),this.dropdown.destroy(),b(this.$node),this.$node=null}}),j}();!function(){var f,b,a;f=H.fn.typeahead,b="ttTypeahead",a={initialize:function(h,g){function d(){var i,e,c=H(this);G.each(g,function(j){j.highlight=!!h.highlight}),e=new r({input:c,eventBus:i=new x({el:c}),withHint:G.isUndefined(h.hint)?!0:!!h.hint,minLength:h.minLength,autoselect:h.autoselect,datasets:g}),c.data(b,e)}return g=G.isArray(g)?g:[].slice.call(arguments,1),h=h||{},this.each(d)},open:function(){function c(){var d,e=H(this);(d=e.data(b))&&d.open()}return this.each(c)},close:function(){function c(){var d,e=H(this);(d=e.data(b))&&d.close()}return this.each(c)},val:function(d){function h(){var j,i=H(this);(j=i.data(b))&&j.setQuery(d)}function g(i){var e,j;return(e=i.data(b))&&(j=e.getQuery()),j}return arguments.length?this.each(h):g(this.first())},destroy:function(){function c(){var d,e=H(this);(d=e.data(b))&&(d.destroy(),e.removeData(b))}return this.each(c)}},H.fn.typeahead=function(c){return a[c]?a[c].apply(this,[].slice.call(arguments,1)):a.initialize.apply(this,arguments)},H.fn.typeahead.noConflict=function(){return H.fn.typeahead=f,this}}()}(window.jQuery);