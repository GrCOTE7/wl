+function(b){var a=function(){this.init()};a.prototype.init=function(){var c=this;this.activeStep=null;this.updateSteps=null};a.prototype.check=function(){var d=b("#updateForm"),c=this;d.request("onCheckForUpdates").done(function(){c.evalConfirmedUpdates()});d.on("change","[data-important-update-select]",function(){var g=b(this),f=g.val(),e=g.closest(".update-item");e.removeClass("item-danger item-muted item-success");if(f=="confirm"){e.addClass("item-success")}else{if(f=="ignore"||f=="skip"){e.addClass("item-muted")}else{e.addClass("item-danger")}}c.evalConfirmedUpdates()})};a.prototype.evalConfirmedUpdates=function(){var c=b("#updateForm"),d=false;b("[data-important-update-select]",c).each(function(){if(b(this).val()==""){d=true}});if(d){b("#updateListUpdateButton").prop("disabled",true);b("#updateListImportantLabel").show()}else{b("#updateListUpdateButton").prop("disabled",false);b("#updateListImportantLabel").hide()}};a.prototype.execute=function(c){this.updateSteps=c;this.runUpdate()};a.prototype.runUpdate=function(c){b.waterfall.apply(this,this.buildEventChain(this.updateSteps,c)).fail(function(f){var e=b("#executeFailed").html(),d=Mustache.to_html(e,{reason:f});b("#executeActivity").hide();b("#executeStatus").html(d)})};a.prototype.retryUpdate=function(){b("#executeActivity").show();b("#executeStatus").html("");this.runUpdate(this.activeStep)};a.prototype.buildEventChain=function(d,g){var c=this,f=[],e=g?true:false;b.each(d,function(h,i){if(i==g){e=false}if(e){return true}f.push(function(){var j=b.Deferred();c.activeStep=i;c.setLoadingBar(true,i.label);b.request("onExecuteStep",{data:i,success:function(k){setTimeout(function(){j.resolve()},600);if(i.code=="completeUpdate"||i.code=="completeInstall"){this.success(k)}else{c.setLoadingBar(false)}},error:function(k){c.setLoadingBar(false);j.reject(k.responseText)}});return j})});return f};a.prototype.setLoadingBar=function(f,e){var d=b("#executeLoadingBar"),c=b("#executeMessage");if(f){d.removeClass("bar-loaded")}else{d.addClass("bar-loaded")}if(e){c.text(e)}};if(b.oc===undefined){b.oc={}}b.oc.updateProcess=new a}(window.jQuery);