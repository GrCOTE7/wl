+function(d){var b=d.oc.foundation.base,a=b.prototype;var c=function(){b.call(this);this.init()};c.prototype=Object.create(a);c.prototype.constructor=b;c.prototype.init=function(){d(document).on("click","[data-inspectable]",this.proxy(this.onInspectableClicked))};c.prototype.getContainerElement=function(f){var e=f.closest("[data-inspector-container]");if(e.length===0){return null}var g=e.find(e.data("inspector-container"));if(g.length===0){throw new Error("Inspector container "+e.data["inspector-container"]+" element is not found.")}return g};c.prototype.loadElementOptions=function(e){var f={};if(e.data("inspector-css-class")){f.inspectorCssClass=e.data("inspector-css-class")}return f};c.prototype.createInspectorPopup=function(e,g){var f=d.extend(this.loadElementOptions(e),{containerSupported:g});new d.oc.inspector.wrappers.popup(e,null,f)};c.prototype.createInspectorContainer=function(e,g){var f=d.extend(this.loadElementOptions(e),{containerSupported:true,container:g});new d.oc.inspector.wrappers.container(e,null,f)};c.prototype.switchToPopup=function(f){var e=d.extend(this.loadElementOptions(f.$element),{containerSupported:true});new d.oc.inspector.wrappers.popup(f.$element,f,e);f.cleanupAfterSwitch();this.setContainerPreference(false)};c.prototype.switchToContainer=function(g){var f=this.getContainerElement(g.$element),e=d.extend(this.loadElementOptions(g.$element),{containerSupported:true,container:f});if(!f){throw new Error("Cannot switch to container: a container element is not found")}new d.oc.inspector.wrappers.container(g.$element,g,e);g.cleanupAfterSwitch();this.setContainerPreference(true)};c.prototype.createInspector=function(f){var e=d(f);if(e.data("oc.inspectorVisible")){return false}var g=this.getContainerElement(e);if(!g){this.createInspectorPopup(e,false)}else{if(!this.applyValuesFromContainer(g)||!this.containerHidingAllowed(g)){return}d.oc.foundation.controlUtils.disposeControls(g.get(0));if(!this.getContainerPreference()){this.createInspectorPopup(e,true)}else{this.createInspectorContainer(e,g)}}};c.prototype.getContainerPreference=function(){if(!Modernizr.localstorage){return false}return localStorage.getItem("oc.inspectorUseContainer")==="true"};c.prototype.setContainerPreference=function(e){if(!Modernizr.localstorage){return}return localStorage.setItem("oc.inspectorUseContainer",e?"true":"false")};c.prototype.applyValuesFromContainer=function(f){var e=d.Event("apply.oc.inspector");f.trigger(e);return !e.isDefaultPrevented()};c.prototype.containerHidingAllowed=function(f){var e=d.Event("beforeContainerHide.oc.inspector");f.trigger(e);return !e.isDefaultPrevented()};c.prototype.onInspectableClicked=function(f){var e=d(f.currentTarget);if(this.createInspector(e)===false){return false}f.stopPropagation();return false};d.oc.inspector.manager=new c();d.fn.inspector=function(){return this.each(function(){d.oc.inspector.manager.createInspector(this)})}}(window.jQuery);