+function(d){var c=d.oc.inspector.wrappers.base,a=c.prototype;var b=function(f,e,g){this.$popoverContainer=null;this.popoverObj=null;this.cleaningUp=false;c.call(this,f,e,g)};b.prototype=Object.create(a);b.prototype.constructor=c;b.prototype.dispose=function(){this.unregisterHandlers();this.$popoverContainer=null;this.popoverObj=null;a.dispose.call(this)};b.prototype.createSurfaceAndUi=function(f,e,h,g){this.showPopover();this.initSurface(this.$popoverContainer.find("[data-surface-container]").get(0),f,e);this.repositionPopover();this.registerPopupHandlers()};b.prototype.adoptSurface=function(){this.showPopover();this.surface.moveToContainer(this.$popoverContainer.find("[data-surface-container]").get(0));this.repositionPopover();this.registerPopupHandlers();a.adoptSurface.call(this)};b.prototype.cleanupAfterSwitch=function(){this.cleaningUp=true;this.switched=true;this.forceClose()};b.prototype.getPopoverContents=function(){return'<div class="popover-head">                                              <h3 data-inspector-title></h3>                                      <p data-inspector-description></p>                                  <button type="button" class="close"                                     data-dismiss="popover"                                              aria-hidden="true">&times;</button>                         </div>                                                              <form autocomplete="off" onsubmit="return false">                       <div data-surface-container></div>                              <form>'};b.prototype.showPopover=function(){var i=this.$element.data("inspector-offset"),e=this.$element.data("inspector-offset-x"),j=this.$element.data("inspector-offset-y"),f=this.$element.data("inspector-placement"),h=this.$element.data("inspector-fallback-placement");if(i===undefined){i=15}if(f===undefined){f="bottom"}if(h===undefined){h="bottom"}this.$element.ocPopover({content:this.getPopoverContents(),highlightModalTarget:true,modal:true,placement:f,fallbackPlacement:h,containerClass:"control-inspector",container:this.$element.data("inspector-container"),offset:i,offsetX:e,offsetY:j,width:400});this.setInspectorVisibleFlag(true);this.popoverObj=this.$element.data("oc.popover");this.$popoverContainer=this.popoverObj.$container;this.$popoverContainer.addClass("inspector-temporary-placement");if(this.options.inspectorCssClass!==undefined){this.$popoverContainer.addClass(this.options.inspectorCssClass)}if(this.options.containerSupported){var g=d('<span class="inspector-move-to-container oc-icon-download">');this.$popoverContainer.find(".popover-head").append(g)}this.$popoverContainer.find("[data-inspector-title]").text(this.title);this.$popoverContainer.find("[data-inspector-description]").text(this.description)};b.prototype.repositionPopover=function(){this.popoverObj.reposition();this.$popoverContainer.removeClass("inspector-temporary-placement");this.$popoverContainer.find("div[data-surface-container] > div").trigger("focus-control")};b.prototype.forceClose=function(){this.$popoverContainer.trigger("close.oc.popover")};b.prototype.registerPopupHandlers=function(){this.surface.options.onPopupDisplayed=this.proxy(this.onPopupEditorDisplayed);this.surface.options.onPopupHidden=this.proxy(this.onPopupEditorHidden);this.popoverObj.options.onCheckDocumentClickTarget=this.proxy(this.onCheckDocumentClickTarget);this.$element.on("hiding.oc.popover",this.proxy(this.onBeforeHide));this.$element.on("hide.oc.popover",this.proxy(this.onHide));this.$popoverContainer.on("keydown",this.proxy(this.onPopoverKeyDown));if(this.options.containerSupported){this.$popoverContainer.on("click","span.inspector-move-to-container",this.proxy(this.onMoveToContainer))}};b.prototype.unregisterHandlers=function(){this.popoverObj.options.onCheckDocumentClickTarget=null;this.$element.off("hiding.oc.popover",this.proxy(this.onBeforeHide));this.$element.off("hide.oc.popover",this.proxy(this.onHide));this.$popoverContainer.off("keydown",this.proxy(this.onPopoverKeyDown));if(this.options.containerSupported){this.$popoverContainer.off("click","span.inspector-move-to-container",this.proxy(this.onMoveToContainer))}this.surface.options.onPopupDisplayed=null;this.surface.options.onPopupHidden=null};b.prototype.onBeforeHide=function(e){if(this.cleaningUp){return}if(!this.surface.validate()){e.preventDefault();return false}if(!this.triggerHiding()){e.preventDefault();return false}this.applyValues()};b.prototype.onHide=function(e){this.dispose()};b.prototype.onPopoverKeyDown=function(e){if(e.keyCode==13){d(e.currentTarget).trigger("close.oc.popover")}};b.prototype.onPopupEditorDisplayed=function(){this.popoverObj.options.closeOnPageClick=false;this.popoverObj.options.closeOnEsc=false};b.prototype.onPopupEditorHidden=function(){this.popoverObj.options.closeOnPageClick=true;this.popoverObj.options.closeOnEsc=true};b.prototype.onCheckDocumentClickTarget=function(e){if(d.contains(this.$element,e)||this.$element.get(0)===e){return true}};b.prototype.onMoveToContainer=function(){d.oc.inspector.manager.switchToContainer(this)};d.oc.inspector.wrappers.popup=b}(window.jQuery);