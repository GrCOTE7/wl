+function(g){var e=g.oc.foundation.base,c=e.prototype,b=0,d=0;var f=function(i,h){this.lists=[];this.options=h;this.listSortableId=null;this.lastMousePosition=null;e.call(this);g.oc.foundation.controlUtils.markDisposable(i);this.init();this.addList(i)};f.prototype=Object.create(c);f.prototype.constructor=f;f.prototype.init=function(){b++;this.listSortableId="listsortable/id/"+b};f.prototype.addList=function(h){this.lists.push(h);this.registerListHandlers(h);if(this.lists.length==1){g(h).one("dispose-control",this.proxy(this.dispose))}};f.prototype.registerListHandlers=function(i){var h=g(i);h.on("dragstart","> li",this.proxy(this.onDragStart));h.on("dragover","> li",this.proxy(this.onDragOver));h.on("dragenter","> li",this.proxy(this.onDragEnter));h.on("dragleave","> li",this.proxy(this.onDragLeave));h.on("drop","> li",this.proxy(this.onDragDrop));h.on("dragend","> li",this.proxy(this.onDragEnd))};f.prototype.unregisterListHandlers=function(i){var h=g(i);h.off("dragstart","> li",this.proxy(this.onDragStart));h.off("dragover","> li",this.proxy(this.onDragOver));h.off("dragenter","> li",this.proxy(this.onDragEnter));h.off("dragleave","> li",this.proxy(this.onDragLeave));h.off("drop","> li",this.proxy(this.onDragDrop));h.off("dragend","> li",this.proxy(this.onDragEnd))};f.prototype.unregisterHandlers=function(){g(document).off("dragover",this.proxy(this.onDocumentDragOver));g(document).off("mousemove",this.proxy(this.onDocumentMouseMove));g(this.lists[0]).off("dispose-control",this.proxy(this.dispose))};f.prototype.unbindLists=function(){for(var h=this.lists.length-1;h>0;h--){var j=this.lists[h];this.unregisterListHandlers(this.lists[h]);g(j).removeData("oc.listSortable")}};f.prototype.dispose=function(){this.unbindLists();this.unregisterHandlers();this.options=null;this.lists=[];c.dispose.call(this)};f.prototype.elementBelongsToManagedList=function(k){for(var j=this.lists.length-1;j>=0;j--){var l=this.lists[j],h=[].slice.call(l.children);if(h.indexOf(k)!==-1){return true}}return false};f.prototype.isDragStartAllowed=function(h){return true};f.prototype.elementIsPlaceholder=function(h){return h.getAttribute("class")==="list-sortable-placeholder"};f.prototype.getElementSortableId=function(i){if(i.hasAttribute("data-list-sortable-element-id")){return i.getAttribute("data-list-sortable-element-id")}d++;var h=d;i.setAttribute("data-list-sortable-element-id",d);return d};f.prototype.dataTransferContains=function(i,h){if(i.dataTransfer.types.indexOf!==undefined){return i.dataTransfer.types.indexOf(h)>=0}return i.dataTransfer.types.contains(h)};f.prototype.isSourceManagedList=function(h){return this.dataTransferContains(h,this.listSortableId)};f.prototype.removePlaceholders=function(){for(var l=this.lists.length-1;l>=0;l--){var m=this.lists[l],h=m.querySelectorAll(".list-sortable-placeholder");for(var k=h.length-1;k>=0;k--){m.removeChild(h[k])}}};f.prototype.createPlaceholder=function(i,j){var k=document.createElement("li"),h=this.getPlaceholderPlacement(i,j);this.removePlaceholders();k.setAttribute("class","list-sortable-placeholder");k.setAttribute("draggable",true);if(h=="before"){i.parentNode.insertBefore(k,i)}else{i.parentNode.insertBefore(k,i.nextSibling)}};f.prototype.moveElement=function(l,j){var k=l.parentNode,m=k.querySelector(".list-sortable-placeholder");if(!m){return}var h=j.dataTransfer.getData("listsortable/elementid");if(!h){return}var i=this.findDraggedItem(h);if(!i){return}m.parentNode.insertBefore(i,m);g(i).trigger("dragged.list.sortable")};f.prototype.findDraggedItem=function(h){for(var j=this.lists.length-1;j>=0;j--){var l=this.lists[j],k=l.querySelector('[data-list-sortable-element-id="'+h+'"]');if(k){return k}}return null};f.prototype.getPlaceholderPlacement=function(h,k){var l=g.oc.foundation.event.pageCoordinates(k),j=g.oc.foundation.element.absolutePosition(h);if(this.options.direction=="vertical"){var i=j.top+h.offsetHeight/2;return l.y<=i?"before":"after"}else{var i=j.left+h.offsetWidth/2;return l.x<=i?"before":"after"}};f.prototype.lastMousePositionChanged=function(h){var i=g.oc.foundation.event.pageCoordinates(h.originalEvent);if(this.lastMousePosition===null||this.lastMousePosition.x!=i.x||this.lastMousePosition.y!=i.y){this.lastMousePosition=i;return true}return false};f.prototype.mouseOutsideLists=function(j){var k=g.oc.foundation.event.pageCoordinates(j);for(var h=this.lists.length-1;h>=0;h--){if(g.oc.foundation.element.elementContainsPoint(this.lists[h],k)){return false}}return true};f.prototype.getClosestDraggableParent=function(h){var i=h;while(i){if(i.tagName==="LI"&&i.hasAttribute("draggable")){return i}i=i.parentNode}return null};f.prototype.onDragStart=function(h){if(!this.isDragStartAllowed(h.target)){return}h.originalEvent.dataTransfer.effectAllowed="move";h.originalEvent.dataTransfer.setData("listsortable/elementid",this.getElementSortableId(h.target));h.originalEvent.dataTransfer.setData(this.listSortableId,this.listSortableId);g(document).on("mousemove",this.proxy(this.onDocumentMouseMove));g(document).on("dragover",this.proxy(this.onDocumentDragOver))};f.prototype.onDragOver=function(i){if(!this.isSourceManagedList(i.originalEvent)){return}var h=this.getClosestDraggableParent(i.target);if(!h){return}if(!this.elementIsPlaceholder(h)&&this.lastMousePositionChanged(i)){this.createPlaceholder(h,i.originalEvent)}i.stopPropagation();i.preventDefault();i.originalEvent.dataTransfer.dropEffect="move"};f.prototype.onDragEnter=function(i){if(!this.isSourceManagedList(i.originalEvent)){return}var h=this.getClosestDraggableParent(i.target);if(!h){return}if(this.elementIsPlaceholder(h)){return}this.createPlaceholder(h,i.originalEvent);i.stopPropagation();i.preventDefault()};f.prototype.onDragLeave=function(h){if(!this.isSourceManagedList(h.originalEvent)){return}h.stopPropagation();h.preventDefault()};f.prototype.onDragDrop=function(i){if(!this.isSourceManagedList(i.originalEvent)){return}var h=this.getClosestDraggableParent(i.target);if(!h){return}this.moveElement(h,i.originalEvent);this.removePlaceholders()};f.prototype.onDragEnd=function(h){g(document).off("dragover",this.proxy(this.onDocumentDragOver))};f.prototype.onDocumentDragOver=function(h){if(!this.isSourceManagedList(h.originalEvent)){return}if(this.mouseOutsideLists(h.originalEvent)){this.removePlaceholders();return}};f.prototype.onDocumentMouseMove=function(h){g(document).off("mousemove",this.proxy(this.onDocumentMouseMove));this.removePlaceholders()};f.DEFAULTS={handle:null,direction:"vertical"};var a=g.fn.listSortable;g.fn.listSortable=function(i){var h=arguments;return this.each(function(){var m=g(this),l=m.data("oc.listSortable"),j=g.extend({},f.DEFAULTS,m.data(),typeof i=="object"&&i);if(!l){m.data("oc.listSortable",(l=new f(this,j)))}if(typeof i=="string"&&l){if(l[i]){var k=Array.prototype.slice.call(h);k.shift();l[i].apply(l,k)}}})};g.fn.listSortable.Constructor=f;g.fn.listSortable.noConflict=function(){g.fn.listSortable=a;return this};g(document).render(function(){g("[data-control=list-sortable]").listSortable()})}(window.jQuery);