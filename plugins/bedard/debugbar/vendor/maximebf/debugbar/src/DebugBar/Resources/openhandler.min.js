if(typeof(PhpDebugBar)=="undefined"){var PhpDebugBar={};PhpDebugBar.$=jQuery}(function(b){var a=function(c){return PhpDebugBar.utils.csscls(c,"phpdebugbar-openhandler-")};PhpDebugBar.OpenHandler=PhpDebugBar.Widget.extend({className:"phpdebugbar-openhandler",defaults:{items_per_page:20},render:function(){var c=this;this.$el.appendTo("body").hide();this.$closebtn=b('<a><i class="phpdebugbar-fa phpdebugbar-fa-times"></i></a>');this.$table=b("<tbody />");b("<div>PHP DebugBar | Open</div>").addClass(a("header")).append(this.$closebtn).appendTo(this.$el);b('<table><thead><tr><th width="150">Date</th><th width="55">Method</th><th>URL</th><th width="125">IP</th><th width="100">Filter data</th></tr></thead></table>').append(this.$table).appendTo(this.$el);this.$actions=b("<div />").addClass(a("actions")).appendTo(this.$el);this.$closebtn.on("click",function(){c.hide()});this.$loadmorebtn=b("<a>Load more</a>").appendTo(this.$actions).on("click",function(){c.find(c.last_find_request,c.last_find_request.offset+c.get("items_per_page"),c.handleFind.bind(c))});this.$showonlycurrentbtn=b("<a>Show only current URL</a>").appendTo(this.$actions).on("click",function(){c.$table.empty();c.find({uri:window.location.pathname},0,c.handleFind.bind(c))});this.$showallbtn=b("<a>Show all</a>").appendTo(this.$actions).on("click",function(){c.refresh()});this.$clearbtn=b("<a>Delete all</a>").appendTo(this.$actions).on("click",function(){c.clear(function(){c.hide()})});this.addSearch();this.$overlay=b("<div />").addClass(a("overlay")).hide().appendTo("body");this.$overlay.on("click",function(){c.hide()})},refresh:function(){this.$table.empty();this.$loadmorebtn.show();this.find({},0,this.handleFind.bind(this))},addSearch:function(){var c=this;var d=b("<button />").text("Search").attr("type","submit").on("click",function(h){c.$table.empty();var g={};var f=b(this).parent().serializeArray();b.each(f,function(){if(this.value){g[this.name]=this.value}});c.find(g,0,c.handleFind.bind(c));h.preventDefault()});b("<form />").append("<br/><b>Filter results</b><br/>").append('Method: <select name="method"><option></option><option>GET</option><option>POST</option><option>PUT</option><option>DELETE</option></select><br/>').append('Uri: <input type="text" name="uri"><br/>').append('IP: <input type="text" name="ip"><br/>').append(d).appendTo(this.$actions)},handleFind:function(d){var c=this;b.each(d,function(g,j){var e=b("<a />").text("Load dataset").on("click",function(i){c.hide();c.load(j.id,function(m){c.callback(j.id,m)});i.preventDefault()});var l=b("<a />").text(j.method).on("click",function(i){c.$table.empty();c.find({method:j.method},0,c.handleFind.bind(c));i.preventDefault()});var h=b("<a />").text(j.uri).on("click",function(i){c.hide();c.load(j.id,function(m){c.callback(j.id,m)});i.preventDefault()});var k=b("<a />").text(j.ip).on("click",function(i){c.$table.empty();c.find({ip:j.ip},0,c.handleFind.bind(c));i.preventDefault()});var f=b("<a />").text("Show URL").on("click",function(i){c.$table.empty();c.find({uri:j.uri},0,c.handleFind.bind(c));i.preventDefault()});b("<tr />").append("<td>"+j.datetime+"</td>").append("<td>"+j.method+"</td>").append(b("<td />").append(h)).append(b("<td />").append(k)).append(b("<td />").append(f)).appendTo(c.$table)});if(d.length<this.get("items_per_page")){this.$loadmorebtn.hide()}},show:function(c){this.callback=c;this.$el.show();this.$overlay.show();this.refresh()},hide:function(){this.$el.hide();this.$overlay.hide()},find:function(c,e,f){var d=b.extend({},c,{max:this.get("items_per_page"),offset:e||0});this.last_find_request=d;this.ajax(d,f)},load:function(d,c){this.ajax({op:"get",id:d},c)},clear:function(c){this.ajax({op:"clear"},c)},ajax:function(c,d){b.ajax({dataType:"json",url:this.get("url"),data:c,success:d,ignoreDebugBarAjaxHandler:true})}})})(PhpDebugBar.$);