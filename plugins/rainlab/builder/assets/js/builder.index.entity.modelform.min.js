+function(d){if(d.oc.builder===undefined){d.oc.builder={}}if(d.oc.builder.entityControllers===undefined){d.oc.builder.entityControllers={}}var c=d.oc.builder.entityControllers.base,b=c.prototype;var a=function(e){c.call(this,"modelForm",e)};a.prototype=Object.create(b);a.prototype.constructor=a;a.prototype.cmdCreateForm=function(f){var e=d(f.currentTarget),g={model_class:e.data("modelClass")};this.indexController.openOrLoadMasterTab(e,"onModelFormCreateOrOpen",this.newTabId(),g)};a.prototype.cmdSaveForm=function(j){var f=d(j.currentTarget),h=f.closest("form"),e=d("[data-root-control-wrapper] > [data-control-container]",h),i=h.find(".inspector-container"),g=d.oc.builder.formbuilder.domToPropertyJson.convert(e.get(0));if(!d.oc.inspector.manager.applyValuesFromContainer(i)){return}if(g===false){d.oc.flashMsg({text:d.oc.builder.formbuilder.domToPropertyJson.getLastError(),"class":"error",interval:5});return}var k={controls:g};f.request("onModelFormSave",{data:k}).done(this.proxy(this.saveFormDone))};a.prototype.cmdOpenForm=function(g){var f=d(g.currentTarget).data("form"),e=d(g.currentTarget).data("modelClass");this.indexController.openOrLoadMasterTab(d(g.target),"onModelFormCreateOrOpen",this.makeTabId(e+"-"+f),{file_name:f,model_class:e})};a.prototype.cmdDeleteForm=function(f){var e=d(f.currentTarget);d.oc.confirm(e.data("confirm"),this.proxy(this.deleteConfirmed))};a.prototype.cmdAddControl=function(e){d.oc.builder.formbuilder.controlPalette.addControl(e)};a.prototype.cmdUndockControlPalette=function(e){d.oc.builder.formbuilder.controlPalette.undockFromContainer(e)};a.prototype.cmdDockControlPalette=function(e){d.oc.builder.formbuilder.controlPalette.dockToContainer(e)};a.prototype.cmdCloseControlPalette=function(e){d.oc.builder.formbuilder.controlPalette.closeInContainer(e)};a.prototype.saveFormDone=function(e){if(e.builderResponseData===undefined){throw new Error("Invalid response data")}var f=this.getMasterTabsActivePane();f.find("input[name=file_name]").val(e.builderResponseData.builderObjectName);this.updateMasterTabIdAndTitle(f,e.builderResponseData);this.unhideFormDeleteButton(f);this.getModelList().fileList("markActive",e.builderResponseData.tabId);this.getIndexController().unchangeTab(f);this.updateDataRegistry(e)};a.prototype.updateDataRegistry=function(f){if(f.builderResponseData.registryData!==undefined){var e=f.builderResponseData.registryData;d.oc.builder.dataRegistry.set(e.pluginCode,"model-forms",e.modelClass,e.forms)}};a.prototype.deleteConfirmed=function(){var f=this.getMasterTabsActivePane(),e=f.find("form");d.oc.stripeLoadIndicator.show();e.request("onModelFormDelete").always(d.oc.builder.indexController.hideStripeIndicatorProxy).done(this.proxy(this.deleteDone))};a.prototype.deleteDone=function(e){var f=this.getMasterTabsActivePane();this.getIndexController().unchangeTab(f);this.forceCloseTab(f);this.updateDataRegistry(e)};a.prototype.getModelList=function(){return d("#layout-side-panel form[data-content-id=models] [data-control=filelist]")};d.oc.builder.entityControllers.modelForm=a}(window.jQuery);